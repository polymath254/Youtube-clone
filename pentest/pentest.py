import requests

BASE_URL = "http://localhost:8000/api/comments/"

def test_unauthenticated_post():
    print("Test: Unauthenticated comment POST")
    data = {"text": "hacked!", "user": "attacker", "video": 1}
    resp = requests.post(BASE_URL, data=data)
    print(f"Status: {resp.status_code}, Response: {resp.text[:200]}")

def test_cors_policy():
    print("Test: CORS headers")
    resp = requests.options(BASE_URL)
    print("CORS:", resp.headers.get("Access-Control-Allow-Origin"))

def test_sql_injection():
    print("Test: SQL Injection attempt")
    data = {"text": "'; DROP TABLE api_comment; --", "user": "attacker", "video": 1}
    resp = requests.post(BASE_URL, data=data)
    print(f"Status: {resp.status_code}, Response: {resp.text[:200]}")

def test_large_payload():
    print("Test: Large payload")
    big_comment = "X" * 100000
    data = {"text": big_comment, "user": "attacker", "video": 1}
    resp = requests.post(BASE_URL, data=data)
    print(f"Status: {resp.status_code}, Response: {resp.text[:200]}")

if __name__ == "__main__":
    test_unauthenticated_post()
    test_cors_policy()
    test_sql_injection()
    test_large_payload()
import requests

BASE_URL = "http://localhost:8000/api/comments/"

def test_unauthenticated_post():
    print("Test: Unauthenticated comment POST")
    data = {"text": "hacked!", "user": "attacker", "video": 1}
    resp = requests.post(BASE_URL, data=data)
    print(f"Status: {resp.status_code}, Response: {resp.text[:200]}")

def test_cors_policy():
    print("Test: CORS headers")
    resp = requests.options(BASE_URL)
    print("CORS:", resp.headers.get("Access-Control-Allow-Origin"))

def test_sql_injection():
    print("Test: SQL Injection attempt")
    data = {"text": "'; DROP TABLE api_comment; --", "user": "attacker", "video": 1}
    resp = requests.post(BASE_URL, data=data)
    print(f"Status: {resp.status_code}, Response: {resp.text[:200]}")

def test_large_payload():
    print("Test: Large payload")
    big_comment = "X" * 100000
    data = {"text": big_comment, "user": "attacker", "video": 1}
    resp = requests.post(BASE_URL, data=data)
    print(f"Status: {resp.status_code}, Response: {resp.text[:200]}")

if __name__ == "__main__":
    test_unauthenticated_post()
    test_cors_policy()
    test_sql_injection()
    test_large_payload()
